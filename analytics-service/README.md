# Analytics Service

**ë¶„ì„ ë° AI ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ì„œë¹„ìŠ¤**

SNS ê³„ì •ê³¼ ê²Œì‹œë¬¼ì˜ ì„±ê³¼ë¥¼ ë¶„ì„í•˜ê³ , AI ê¸°ë°˜ ê°ì • ë¶„ì„ì„ í†µí•´ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë¶„ì„ê³¼ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ í†µí•œ íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„° ë¶„ì„, YouTube APIë¥¼ í™œìš©í•œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“‹ ê°œìš”

- **í¬íŠ¸**: 8086
- **ì£¼ìš” ê¸°ëŠ¥**: ì‹¤ì‹œê°„ ë¶„ì„, ë°°ì¹˜ ë°ì´í„° ì²˜ë¦¬, AI ê°ì • ë¶„ì„, ì„±ê³¼ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- **í”„ë ˆì„ì›Œí¬**: Spring Boot, Spring Batch, YouTube Data API, Redis

## ğŸ”§ ì£¼ìš” ê¸°ëŠ¥

### 1. ì‹¤ì‹œê°„ ë¶„ì„
- **ê³„ì • ë©”íŠ¸ë¦­**: êµ¬ë…ì, ì´ ì¡°íšŒìˆ˜, ê²Œì‹œë¬¼ ìˆ˜ ì‹¤ì‹œê°„ ì¶”ì 
- **ê²Œì‹œë¬¼ ì„±ê³¼**: ê°œë³„ ê²Œì‹œë¬¼ì˜ ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ëŒ“ê¸€ ìˆ˜ ëª¨ë‹ˆí„°ë§
- **íŠ¸ë Œë“œ ë¶„ì„**: ì‹œê°„ëŒ€ë³„ ì„±ê³¼ ë³€í™” ì¶”ì 
- **Redis ìºì‹±**: ë¹ ë¥¸ ë°ì´í„° ì¡°íšŒë¥¼ ìœ„í•œ ë‹¤ì¸µ ìºì‹±

### 2. ë°°ì¹˜ ë°ì´í„° ì²˜ë¦¬
- **Spring Batch**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë°°ì¹˜ ì‘ì—…
- **ì¼ì¼ í†µê³„**: ë§¤ì¼ ìë™ ì‹¤í–‰ë˜ëŠ” ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‘ì—…
- **íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°**: ê³¼ê±° ë°ì´í„° ë¶„ì„ ë° íŠ¸ë Œë“œ íŒŒì•…
- **ETL í”„ë¡œì„¸ìŠ¤**: YouTube APIì—ì„œ ë°ì´í„° ì¶”ì¶œ, ë³€í™˜, ì ì¬

### 3. AI ê°ì • ë¶„ì„
- **ëŒ“ê¸€ ê°ì • ë¶„ì„**: AI ê¸°ë°˜ ëŒ“ê¸€ ê°ì • ìƒíƒœ ë¶„ì„
- **í‚¤ì›Œë“œ ì¶”ì¶œ**: ëŒ“ê¸€ì—ì„œ ì£¼ìš” í‚¤ì›Œë“œ ìë™ ì¶”ì¶œ
- **ê°ì • í†µê³„**: ê¸ì •/ë¶€ì •/ì¤‘ë¦½ ê°ì • ë¹„ìœ¨ ë¶„ì„
- **FastAPI í†µí•©**: ì™¸ë¶€ AI ì„œë¹„ìŠ¤ì™€ì˜ ì—°ë™

### 4. ì„±ê³¼ ë¦¬í¬íŒ…
- **ì¢…í•© ë¦¬í¬íŠ¸**: ê³„ì • ì „ì²´ ì„±ê³¼ ì¢…í•© ë¶„ì„
- **ë¹„êµ ë¶„ì„**: ê¸°ê°„ë³„, ê²Œì‹œë¬¼ë³„ ì„±ê³¼ ë¹„êµ
- **ì¸ì‚¬ì´íŠ¸ ì œê³µ**: AI ê¸°ë°˜ ê°œì„  ì œì•ˆì‚¬í•­
- **ì‹œê°í™” ë°ì´í„°**: ì°¨íŠ¸ ë° ê·¸ë˜í”„ìš© ë°ì´í„° ì œê³µ

### 5. ì´ë²¤íŠ¸ ê¸°ë°˜ ë°ì´í„° ìˆ˜ì§‘
- **Kafka í†µí•©**: SNS ì„œë¹„ìŠ¤ë¡œë¶€í„° ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
- **ìë™ ë™ê¸°í™”**: ê³„ì • ë° ê²Œì‹œë¬¼ ë³€ê²½ì‚¬í•­ ìë™ ë°˜ì˜
- **ì´ë²¤íŠ¸ ì†Œì‹±**: ëª¨ë“  ë³€ê²½ì‚¬í•­ì˜ íˆìŠ¤í† ë¦¬ ê´€ë¦¬

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ êµ¬ì¡°
```
â”œâ”€â”€ domain/                    # ë„ë©”ì¸ ê³„ì¸µ
â”‚   â””â”€â”€ entity/               # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚       â”œâ”€â”€ SnsAccount.java   # SNS ê³„ì •
â”‚       â”œâ”€â”€ SnsPost.java      # SNS ê²Œì‹œë¬¼
â”‚       â”œâ”€â”€ SnsAccountMetric.java # ê³„ì • ë©”íŠ¸ë¦­
â”‚       â”œâ”€â”€ SnsPostMetric.java    # ê²Œì‹œë¬¼ ë©”íŠ¸ë¦­
â”‚       â”œâ”€â”€ SnsPostCommentMetric.java # ëŒ“ê¸€ ë©”íŠ¸ë¦­
â”‚       â”œâ”€â”€ PostCommentKeyword.java   # ëŒ“ê¸€ í‚¤ì›Œë“œ
â”‚       â””â”€â”€ BaseEntity.java   # ê¸°ë³¸ ì—”í‹°í‹°
â”œâ”€â”€ application/               # ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ
â”‚   â”œâ”€â”€ port/in/              # ì¸ë°”ìš´ë“œ í¬íŠ¸
â”‚   â”‚   â”œâ”€â”€ AnalyticsQueryUseCase.java    # ë¶„ì„ ì¡°íšŒ
â”‚   â”‚   â”œâ”€â”€ AnalyticsEventUseCase.java    # ì´ë²¤íŠ¸ ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ EmotionAnalysisUseCase.java   # ê°ì • ë¶„ì„
â”‚   â”‚   â”œâ”€â”€ MetricsCollectionUseCase.java # ë©”íŠ¸ë¦­ ìˆ˜ì§‘
â”‚   â”‚   â””â”€â”€ dto/              # ì• í”Œë¦¬ì¼€ì´ì…˜ DTO
â”‚   â”œâ”€â”€ port/out/             # ì•„ì›ƒë°”ìš´ë“œ í¬íŠ¸
â”‚   â”‚   â”œâ”€â”€ repository/       # ë¦¬í¬ì§€í† ë¦¬ í¬íŠ¸
â”‚   â”‚   â””â”€â”€ infrastructure/   # ì¸í”„ë¼ í¬íŠ¸
â”‚   â”‚       â”œâ”€â”€ AiAnalysisPort.java      # AI ë¶„ì„ í¬íŠ¸
â”‚   â”‚       â”œâ”€â”€ ExternalApiPort.java     # ì™¸ë¶€ API í¬íŠ¸
â”‚   â”‚       â””â”€â”€ ValidationPort.java      # ê²€ì¦ í¬íŠ¸
â”‚   â””â”€â”€ service/              # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ AnalyticsQueryService.java   # ë¶„ì„ ì¡°íšŒ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ AnalyticsEventService.java   # ì´ë²¤íŠ¸ ì²˜ë¦¬ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ EmotionAnalysisService.java  # ê°ì • ë¶„ì„ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ MetricsCollectionService.java # ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì„œë¹„ìŠ¤
â”‚       â”œâ”€â”€ BatchJobMonitor.java         # ë°°ì¹˜ ì‘ì—… ëª¨ë‹ˆí„°
â”‚       â”œâ”€â”€ BatchScheduler.java          # ë°°ì¹˜ ìŠ¤ì¼€ì¤„ëŸ¬
â”‚       â””â”€â”€ EmotionAnalysisBatchService.java # ê°ì • ë¶„ì„ ë°°ì¹˜
â””â”€â”€ adapter/                   # ì–´ëŒ‘í„° ê³„ì¸µ
    â”œâ”€â”€ in/                   # ì¸ë°”ìš´ë“œ ì–´ëŒ‘í„°
    â”‚   â”œâ”€â”€ web/              # ì›¹ ì–´ëŒ‘í„°
    â”‚   â”‚   â”œâ”€â”€ RealtimeAnalyticsController.java
    â”‚   â”‚   â”œâ”€â”€ HistoricalAnalyticsController.java
    â”‚   â”‚   â”œâ”€â”€ BatchController.java
    â”‚   â”‚   â””â”€â”€ dto/response/ # ì‘ë‹µ DTO
    â”‚   â””â”€â”€ event/consumer/   # ì´ë²¤íŠ¸ ì»¨ìŠˆë¨¸
    â”‚       â”œâ”€â”€ PostEventConsumer.java
    â”‚       â””â”€â”€ SnsAccountEventConsumer.java
    â””â”€â”€ out/                  # ì•„ì›ƒë°”ìš´ë“œ ì–´ëŒ‘í„°
        â”œâ”€â”€ persistence/      # ë°ì´í„°ë² ì´ìŠ¤ ì–´ëŒ‘í„°
        â”‚   â””â”€â”€ repository/   # JPA ë¦¬í¬ì§€í† ë¦¬
        â””â”€â”€ infrastructure/   # ì¸í”„ë¼ ì–´ëŒ‘í„°
            â”œâ”€â”€ AiAnalysisAdapter.java       # AI ë¶„ì„ ì–´ëŒ‘í„°
            â”œâ”€â”€ YouTubeApiAdapter.java       # YouTube API ì–´ëŒ‘í„°
            â””â”€â”€ AnalyticsValidationAdapter.java # ê²€ì¦ ì–´ëŒ‘í„°
```

### Spring Batch êµ¬ì¡°
```
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ BatchConfig.java      # ë°°ì¹˜ ì„¤ì •
â”‚   â””â”€â”€ AsyncConfig.java      # ë¹„ë™ê¸° ì²˜ë¦¬ ì„¤ì •
â”œâ”€â”€ job/
â”‚   â”œâ”€â”€ MetricsCollectionJob.java     # ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‘ì—…
â”‚   â”œâ”€â”€ EmotionAnalysisJob.java       # ê°ì • ë¶„ì„ ì‘ì—…
â”‚   â””â”€â”€ HistoricalDataJob.java        # íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„° ì‘ì—…
â””â”€â”€ step/
    â”œâ”€â”€ AccountMetricsStep.java       # ê³„ì • ë©”íŠ¸ë¦­ ìŠ¤í…
    â”œâ”€â”€ PostMetricsStep.java          # ê²Œì‹œë¬¼ ë©”íŠ¸ë¦­ ìŠ¤í…
    â””â”€â”€ CommentAnalysisStep.java      # ëŒ“ê¸€ ë¶„ì„ ìŠ¤í…
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### SnsAccountMetric í…Œì´ë¸”
```sql
CREATE TABLE sns_account_metrics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sns_account_id BIGINT NOT NULL,
    follower_count BIGINT DEFAULT 0,
    following_count BIGINT DEFAULT 0,
    total_view_count BIGINT DEFAULT 0,
    total_post_count INT DEFAULT 0,
    engagement_rate DECIMAL(5,2) DEFAULT 0.00,
    growth_rate DECIMAL(5,2) DEFAULT 0.00,
    metric_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE INDEX idx_account_date (sns_account_id, metric_date),
    INDEX idx_metric_date (metric_date)
);
```

### SnsPostMetric í…Œì´ë¸”
```sql
CREATE TABLE sns_post_metrics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sns_post_id BIGINT NOT NULL,
    view_count BIGINT DEFAULT 0,
    like_count BIGINT DEFAULT 0,
    dislike_count BIGINT DEFAULT 0,
    comment_count BIGINT DEFAULT 0,
    share_count BIGINT DEFAULT 0,
    engagement_rate DECIMAL(5,2) DEFAULT 0.00,
    watch_time_seconds BIGINT DEFAULT 0,
    metric_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE INDEX idx_post_date (sns_post_id, metric_date),
    INDEX idx_metric_date (metric_date)
);
```

### SnsPostCommentMetric í…Œì´ë¸”
```sql
CREATE TABLE sns_post_comment_metrics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sns_post_id BIGINT NOT NULL,
    total_comments INT DEFAULT 0,
    positive_sentiment_count INT DEFAULT 0,
    negative_sentiment_count INT DEFAULT 0,
    neutral_sentiment_count INT DEFAULT 0,
    positive_ratio DECIMAL(5,2) DEFAULT 0.00,
    negative_ratio DECIMAL(5,2) DEFAULT 0.00,
    average_sentiment_score DECIMAL(3,2) DEFAULT 0.00,
    metric_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE INDEX idx_post_comment_date (sns_post_id, metric_date)
);
```

### PostCommentKeyword í…Œì´ë¸”
```sql
CREATE TABLE post_comment_keywords (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sns_post_id BIGINT NOT NULL,
    keyword VARCHAR(100) NOT NULL,
    frequency INT DEFAULT 1,
    sentiment VARCHAR(20) DEFAULT 'NEUTRAL',
    metric_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_post_keyword (sns_post_id, keyword),
    INDEX idx_keyword_frequency (keyword, frequency DESC)
);
```

## âš™ï¸ API ì—”ë“œí¬ì¸íŠ¸

### ì‹¤ì‹œê°„ ë¶„ì„ API

#### ê³„ì • ë©”íŠ¸ë¦­ ì¡°íšŒ
```http
GET /api/analytics/realtime/accounts/{accountId}/metrics?period=7d
Authorization: Bearer {token}
```

**ì‘ë‹µ:**
```json
{
    "code": "SUCCESS",
    "message": "ì‹¤ì‹œê°„ ê³„ì • ë©”íŠ¸ë¦­ ì¡°íšŒ ì„±ê³µ",
    "data": {
        "accountId": 1,
        "accountName": "ë‚´ ìœ íŠœë¸Œ ì±„ë„",
        "currentMetrics": {
            "followerCount": 1520,
            "totalViewCount": 52000,
            "totalPostCount": 28,
            "engagementRate": 3.45,
            "growthRate": 2.1
        },
        "periodComparison": {
            "followerGrowth": "+20",
            "viewGrowth": "+1500",
            "postGrowth": "+3",
            "engagementChange": "+0.25"
        },
        "trendData": [
            {
                "date": "2024-01-01",
                "followers": 1500,
                "views": 50500,
                "engagement": 3.2
            }
        ]
    }
}
```

#### ê²Œì‹œë¬¼ ì„±ê³¼ ë¶„ì„
```http
GET /api/analytics/realtime/posts/{postId}/metrics
Authorization: Bearer {token}
```

**ì‘ë‹µ:**
```json
{
    "code": "SUCCESS",
    "message": "ê²Œì‹œë¬¼ ì„±ê³¼ ë¶„ì„ ì¡°íšŒ ì„±ê³µ",
    "data": {
        "postId": 1,
        "title": "ìš°ë¦¬ ë§¤ì¥ ì†Œê°œ ì˜ìƒ",
        "currentMetrics": {
            "viewCount": 3200,
            "likeCount": 145,
            "commentCount": 23,
            "shareCount": 12,
            "engagementRate": 5.62,
            "watchTimeSeconds": 1800
        },
        "performanceAnalysis": {
            "ranking": "ìƒìœ„ 20%",
            "peakViewTime": "2024-01-01T15:30:00",
            "audienceRetention": 78.5,
            "clickThroughRate": 4.2
        }
    }
}
```

### íˆìŠ¤í† ë¦¬ì»¬ ë¶„ì„ API

#### ê³„ì • íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„°
```http
GET /api/analytics/historical/accounts/{accountId}?startDate=2024-01-01&endDate=2024-01-31
Authorization: Bearer {token}
```

#### íŠ¸ë Œë“œ ë¶„ì„
```http
GET /api/analytics/historical/trends?accountId=1&metric=engagement&period=30d
Authorization: Bearer {token}
```

### ê°ì • ë¶„ì„ API

#### ê²Œì‹œë¬¼ ëŒ“ê¸€ ê°ì • ë¶„ì„
```http
GET /api/analytics/emotion/posts/{postId}/comments
Authorization: Bearer {token}
```

**ì‘ë‹µ:**
```json
{
    "code": "SUCCESS",
    "message": "ëŒ“ê¸€ ê°ì • ë¶„ì„ ê²°ê³¼",
    "data": {
        "postId": 1,
        "totalComments": 150,
        "sentimentDistribution": {
            "positive": 85,
            "negative": 25,
            "neutral": 40
        },
        "sentimentRatios": {
            "positiveRatio": 56.67,
            "negativeRatio": 16.67,
            "neutralRatio": 26.67
        },
        "averageSentimentScore": 0.65,
        "topKeywords": [
            {
                "keyword": "ë§›ìˆë‹¤",
                "frequency": 12,
                "sentiment": "POSITIVE"
            },
            {
                "keyword": "ì¢‹ë‹¤",
                "frequency": 8,
                "sentiment": "POSITIVE"
            },
            {
                "keyword": "ë¹„ì‹¸ë‹¤",
                "frequency": 5,
                "sentiment": "NEGATIVE"
            }
        ]
    }
}
```

### ë¦¬í¬íŠ¸ API

#### ì¢…í•© ë¦¬í¬íŠ¸ ìƒì„±
```http
POST /api/analytics/reports/comprehensive
Authorization: Bearer {token}
Content-Type: application/json

{
    "accountIds": [1, 2],
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "includeEmotionAnalysis": true,
    "includeTrendAnalysis": true
}
```

### ë°°ì¹˜ ì‘ì—… ê´€ë¦¬ API

#### ë°°ì¹˜ ì‘ì—… ìƒíƒœ ì¡°íšŒ
```http
GET /api/analytics/batch/jobs/{jobId}/status
Authorization: Bearer {token}
```

#### ìˆ˜ë™ ë°°ì¹˜ ì‘ì—… ì‹¤í–‰
```http
POST /api/analytics/batch/jobs/metrics-collection/trigger
Authorization: Bearer {token}
```

## ğŸ¤– AI ê°ì • ë¶„ì„ í†µí•©

### FastAPI ê°ì • ë¶„ì„ ì„œë¹„ìŠ¤ í†µì‹ 

#### ëŒ“ê¸€ ê°ì • ë¶„ì„ ìš”ì²­
```json
POST http://localhost:8000/api/ai/emotion/analyze
{
    "texts": [
        "ì •ë§ ë§›ìˆì–´ìš”! ë˜ ê°€ê³  ì‹¶ìŠµë‹ˆë‹¤.",
        "ê°€ê²©ì´ ì¢€ ë¹„ì‹¼ ê²ƒ ê°™ì•„ìš”",
        "ì„œë¹„ìŠ¤ê°€ ì¹œì ˆí–ˆìŠµë‹ˆë‹¤"
    ],
    "language": "ko"
}
```

**ì‘ë‹µ:**
```json
{
    "results": [
        {
            "text": "ì •ë§ ë§›ìˆì–´ìš”! ë˜ ê°€ê³  ì‹¶ìŠµë‹ˆë‹¤.",
            "sentiment": "POSITIVE",
            "confidence": 0.92,
            "score": 0.85
        },
        {
            "text": "ê°€ê²©ì´ ì¢€ ë¹„ì‹¼ ê²ƒ ê°™ì•„ìš”",
            "sentiment": "NEGATIVE",
            "confidence": 0.78,
            "score": -0.45
        },
        {
            "text": "ì„œë¹„ìŠ¤ê°€ ì¹œì ˆí–ˆìŠµë‹ˆë‹¤",
            "sentiment": "POSITIVE",
            "confidence": 0.88,
            "score": 0.67
        }
    ]
}
```

#### í‚¤ì›Œë“œ ì¶”ì¶œ ìš”ì²­
```json
POST http://localhost:8000/api/ai/keywords/extract
{
    "texts": [
        "ë§›ìˆëŠ” ìŒì‹ê³¼ ì¹œì ˆí•œ ì„œë¹„ìŠ¤ê°€ ì¸ìƒì ì´ì—ˆìŠµë‹ˆë‹¤",
        "ë¶„ìœ„ê¸°ê°€ ì¢‹ê³  ê°€ê²©ë„ í•©ë¦¬ì ì´ì—ìš”"
    ],
    "language": "ko",
    "maxKeywords": 10
}
```

## ğŸ“Š Spring Batch ì‘ì—…

### ì¼ì¼ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‘ì—…

#### Job ì„¤ì •
```java
@Configuration
public class MetricsCollectionJobConfig {
    
    @Bean
    public Job metricsCollectionJob() {
        return jobBuilderFactory.get("metricsCollectionJob")
            .start(accountMetricsStep())
            .next(postMetricsStep())
            .next(commentAnalysisStep())
            .build();
    }
    
    // ë§¤ì¼ ìƒˆë²½ 2ì‹œ ì‹¤í–‰
    @Scheduled(cron = "0 0 2 * * *")
    public void runDailyMetricsCollection() {
        jobLauncher.run(metricsCollectionJob(), new JobParameters());
    }
}
```

### ë°°ì¹˜ ì‘ì—… ëª¨ë‹ˆí„°ë§
```java
@Component
public class BatchJobMonitor {
    
    @EventListener
    public void handleJobExecution(JobExecutionEvent event) {
        // ì‘ì—… ì‹¤í–‰ ìƒíƒœ ëª¨ë‹ˆí„°ë§
        // ì‹¤íŒ¨ ì‹œ ì•Œë¦¼ ë°œì†¡
        // ë©”íŠ¸ë¦­ ìˆ˜ì§‘
    }
}
```

## âš™ï¸ ì„¤ì •

### Redis ìºì‹± ì„¤ì •
```yaml
spring:
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      timeout: 2000ms
  cache:
    type: redis
    cache-names:
      - analytics-realtime
      - analytics-historical
      - emotion-analysis
    redis:
      time-to-live: 3600000  # 1 hour
```

### Spring Batch ì„¤ì •
```yaml
spring:
  batch:
    jdbc:
      initialize-schema: always
    job:
      enabled: false  # ìˆ˜ë™ ì‹¤í–‰
  task:
    execution:
      pool:
        core-size: 10
        max-size: 20
        queue-capacity: 100
```

### YouTube API ì„¤ì •
```yaml
youtube:
  api:
    key: ${YOUTUBE_API_KEY}
    quota:
      daily-limit: 10000
      analytics-calls: 2000
```

### AI ì„œë¹„ìŠ¤ ì„¤ì •
```yaml
ai:
  service:
    emotion-analysis:
      url: ${AI_SERVICE_URL:http://localhost:8000}
      timeout: 30s
      batch-size: 100
```

## ğŸš€ ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì •

### Prerequisites
- Java 17+
- MySQL 8.0+
- Redis 7.2+
- Kafka
- YouTube Data API í‚¤
- FastAPI AI Service

### AI ì„œë¹„ìŠ¤ ì‹¤í–‰
```bash
# FastAPI AI ì„œë¹„ìŠ¤ ì‹¤í–‰
cd ai-service
pip install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8000
```

### Analytics Service ì‹¤í–‰
```bash
# Gradleì„ í†µí•œ ì‹¤í–‰
./gradlew :analytics-service:bootRun

# JAR íŒŒì¼ ì‹¤í–‰
java -jar analytics-service/build/libs/analytics-service-0.0.1-SNAPSHOT.jar

# Dockerë¥¼ í†µí•œ ì‹¤í–‰
docker build -t marketing-analytics-service .
docker run -p 8086:8086 marketing-analytics-service
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# Database
export DB_HOST=localhost
export DB_PORT=3306
export DB_NAME=marketing
export DB_USERNAME=marketing_user
export DB_PASSWORD=password

# Redis
export REDIS_HOST=localhost
export REDIS_PORT=6379
export REDIS_PASSWORD=redis_password

# YouTube API
export YOUTUBE_API_KEY=your-youtube-api-key

# AI Service
export AI_SERVICE_URL=http://localhost:8000

# Kafka
export KAFKA_SERVERS=localhost:9092
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### Unit Tests
```bash
./gradlew :analytics-service:test
```

### Integration Tests
```bash
./gradlew :analytics-service:integrationTest
```

### API í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
```bash
# ì‹¤ì‹œê°„ ê³„ì • ë©”íŠ¸ë¦­ ì¡°íšŒ í…ŒìŠ¤íŠ¸
curl -H "Authorization: Bearer {your-jwt-token}" \
  "http://localhost:8086/api/analytics/realtime/accounts/1/metrics?period=7d"

# ê°ì • ë¶„ì„ í…ŒìŠ¤íŠ¸
curl -H "Authorization: Bearer {your-jwt-token}" \
  http://localhost:8086/api/analytics/emotion/posts/1/comments

# ë°°ì¹˜ ì‘ì—… ì‹¤í–‰ í…ŒìŠ¤íŠ¸
curl -X POST \
  -H "Authorization: Bearer {your-jwt-token}" \
  http://localhost:8086/api/analytics/batch/jobs/metrics-collection/trigger
```

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Health Check
```bash
curl http://localhost:8086/actuator/health
```

### Metrics
- ì‹¤ì‹œê°„ ë¶„ì„ ì‘ë‹µ ì‹œê°„
- ë°°ì¹˜ ì‘ì—… ì„±ê³µ/ì‹¤íŒ¨ìœ¨
- AI ê°ì • ë¶„ì„ ì •í™•ë„
- ìºì‹œ íˆíŠ¸ìœ¨
- YouTube API ì‚¬ìš©ëŸ‰

### Custom Metrics
```java
@Component
public class AnalyticsMetrics {
    private final Counter analysisRequests;
    private final Timer batchJobDuration;
    private final Gauge cacheHitRate;
    
    // ë¶„ì„ ì„œë¹„ìŠ¤ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
}
```

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. ë°°ì¹˜ ì‘ì—… ì‹¤íŒ¨
- **ì¦ìƒ**: ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: 
  - YouTube API ì¿¼í„° ì´ˆê³¼
  - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
  - ë©”ëª¨ë¦¬ ë¶€ì¡±
- **í•´ê²°**: API ì‚¬ìš©ëŸ‰ í™•ì¸, DB ì—°ê²° ìƒíƒœ ì ê²€, ë©”ëª¨ë¦¬ ì„¤ì • ì¡°ì •

#### 2. ì‹¤ì‹œê°„ ë°ì´í„° ì§€ì—°
- **ì¦ìƒ**: ìµœì‹  ë°ì´í„°ê°€ ë°˜ì˜ë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: Redis ìºì‹œ ì„¤ì • ì˜¤ë¥˜ ë˜ëŠ” Kafka ì§€ì—°
- **í•´ê²°**: ìºì‹œ ì„¤ì • í™•ì¸, Kafka ì»¨ìŠˆë¨¸ ìƒíƒœ ì ê²€

#### 3. AI ê°ì • ë¶„ì„ ì˜¤ë¥˜
- **ì¦ìƒ**: ê°ì • ë¶„ì„ ê²°ê³¼ê°€ ë¶€ì •í™•í•˜ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ
- **ì›ì¸**: AI ì„œë¹„ìŠ¤ ì—°ê²° ì‹¤íŒ¨ ë˜ëŠ” í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬ ì˜¤ë¥˜
- **í•´ê²°**: AI ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸, í…ìŠ¤íŠ¸ ë°ì´í„° ê²€ì¦

#### 4. ë©”íŠ¸ë¦­ ë°ì´í„° ë¶ˆì¼ì¹˜
- **ì¦ìƒ**: ì„œë¡œ ë‹¤ë¥¸ APIì—ì„œ ë‹¤ë¥¸ ê²°ê³¼ ë°˜í™˜
- **ì›ì¸**: ìºì‹œ ë™ê¸°í™” ë¬¸ì œ ë˜ëŠ” ë°ì´í„° ì •í•©ì„± ì˜¤ë¥˜
- **í•´ê²°**: ìºì‹œ ì´ˆê¸°í™”, ë°ì´í„° ì¬ë™ê¸°í™” ì‘ì—… ì‹¤í–‰

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
```sql
-- ë©”íŠ¸ë¦­ ì¡°íšŒ ìµœì í™”ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_account_metric_date ON sns_account_metrics(sns_account_id, metric_date DESC);
CREATE INDEX idx_post_metric_date ON sns_post_metrics(sns_post_id, metric_date DESC);

-- íŒŒí‹°ì…”ë‹ìœ¼ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ìµœì í™”
ALTER TABLE sns_account_metrics PARTITION BY RANGE (YEAR(metric_date));
```

### ìºì‹± ì „ëµ ìµœì í™”
```java
@Service
public class AnalyticsCache {
    
    // ì‹¤ì‹œê°„ ë°ì´í„° ìºì‹± (5ë¶„)
    @Cacheable(value = "realtime-metrics", key = "#accountId")
    public AccountMetrics getRealtimeMetrics(Long accountId);
    
    // íˆìŠ¤í† ë¦¬ì»¬ ë°ì´í„° ìºì‹± (1ì‹œê°„)
    @Cacheable(value = "historical-metrics", key = "#accountId + '_' + #period")
    public List<MetricData> getHistoricalMetrics(Long accountId, String period);
}
```

### ë°°ì¹˜ ì²˜ë¦¬ ìµœì í™”
```java
@Configuration
public class BatchOptimizationConfig {
    
    @Bean
    public Step optimizedMetricsStep() {
        return stepBuilderFactory.get("optimizedMetricsStep")
            .<InputData, OutputData>chunk(1000)  // ì²­í¬ í¬ê¸° ìµœì í™”
            .reader(parallelReader())             // ë³‘ë ¬ ì²˜ë¦¬
            .processor(asyncProcessor())          // ë¹„ë™ê¸° ì²˜ë¦¬
            .writer(batchWriter())                // ë°°ì¹˜ ì“°ê¸°
            .taskExecutor(taskExecutor())         // ë©€í‹°ìŠ¤ë ˆë“œ
            .build();
    }
}
```

## ğŸ”§ ìš´ì˜ ê³ ë ¤ì‚¬í•­

### ë¡œê¹… ì„¤ì •
```yaml
logging:
  level:
    kt.aivle.analytics: INFO
    org.springframework.batch: DEBUG
    org.springframework.kafka: INFO
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
```

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- ë¶„ì„ ë°ì´í„° ì ‘ê·¼ ê¶Œí•œ ì œì–´
- ë¯¼ê°í•œ ë©”íŠ¸ë¦­ ì •ë³´ ì•”í˜¸í™”
- API ë ˆì´íŠ¸ ë¦¬ë¯¸íŒ…
- ë°ì´í„° ìµëª…í™” ì²˜ë¦¬

### í™•ì¥ì„± ê³ ë ¤ì‚¬í•­
- ë¶„ì‚° ìºì‹œ ì‹œìŠ¤í…œ ë„ì…
- ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ íŒŒí‹°ì…”ë‹
- ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ (Kafka Streams)
- ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ì˜ˆì¸¡ ë¶„ì„ ê¸°ëŠ¥

---

**ì„œë¹„ìŠ¤ ë‹´ë‹¹**: Analytics Team  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2024ë…„